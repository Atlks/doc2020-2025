Atitit  提升进度大法---通用json dsl接口.docx

1. Dsl的重要性	1
2. Json dsl接口	1
2.1. Url：  http://aaa.com/api_jsondsl?dsl={}	1
2.2. 参数为json对象，具体字段如下	1
2.3. 返回 ：json数组。	2
3. 接口数据发送范例：查询用户数据	2
3.1. 增加数据	3
3.2. 修改数据	3
4. 前段见面js调用范例	4
4.1. 查询	4
4.2. 添加数据	4
4.3. 修改数据	5


Dsl的重要性
界面dsl有h5 ,可以跨项目通用,  数据库有sql 作为dsl
界面交互上，也急需一个通用dsl，提升界面交互速度。。

目标：：免文档  可读性高 通用 跨项目 高安全性 高性能 高扩展

Json dsl接口
Url：  http://aaa.com/api_jsondsl?dsl={}

参数为json对象，具体字段如下


返回 ：json数组。

接口数据发送范例：查询用户数据
http://aaa.com/api_jsondsl?dsl= {
    "操作": "查询", 
    "数据类型": "用户数据", 
    "查询属性": "用户名,年龄,电话", 
    "条件": "用户名='王伟' and  电话='1356666666'", 
    "数据排序依据字段": "电话,用户名 倒排", 
    "页数": 2, 
    "每页条数": 10
}

注意：dsl参数需要urlencode，这里为了可读性暂时不编码
增加数据
http://aaa.com/api_jsondsl?dsl= {
    "操作": "添加数据", 
    "数据类型": "用户数据", 
    "内容": [        {
            "用户名": "王伟", 
            "电话": "123"
        },         {
            "用户名": "李三", 
            "电话": "456"
        }
    ]
}
修改数据
http://aaa.com/api_jsondsl?dsl= {
    "操作": "修改数据", 
    "数据类型": "用户数据", 
    "内容": [        {
            "用户名": "王伟", 
            "电话": "123"
        },         {
            "用户名": "李三", 
            "电话": "456"
        }
],
    "条件": "id=34"
}



前段见面js调用范例

查询
<textarea  id="txt" style="width:700px;height:700px" ></textarea>
<meta http-equiv=Content-Type content="text/html; charset=gbk">
<script>

function 按照(col)
{

return {
	倒排:function(){return  col+" desc" }
};
}


发送参数={};
发送参数.操作="查询"
发送参数.数据类型="用户数据"
发送参数.查询属性="用户名,年龄,电话";
发送参数.条件="用户名='王伟' and  电话='1356666666'";
发送参数.数据排序依据字段="用户名 倒排"
发送参数.页数=2;
发送参数.每页记录数=10;

 //document.getElementById('txt').value=JSON.stringify(发送参数); 

 添加数据
 发送参数={};
发送参数.操作="添加数据"
发送参数.数据类型="用户数据"
 
发送参数.内容=[];
发送参数.内容.push({});
发送参数.内容[0].用户名="王伟";
发送参数.内容[0].电话="123";
发送参数.内容.push({});
发送参数.内容[1].用户名="李三";
发送参数.内容[1].电话="456";
 
//document.getElementById('txt').value=JSON.stringify(发送参数); 


修改数据
 发送参数={};
发送参数.操作="修改数据"
发送参数.数据类型="用户数据"
 
发送参数.内容=[];
发送参数.内容.push({});
发送参数.内容[0].用户名="王伟";
发送参数.内容[0].电话="123";
发送参数.内容.push({});
发送参数.内容[1].用户名="李三";
发送参数.内容[1].电话="456";
 发送参数.条件="id=34"
document.getElementById('txt').value=JSON.stringify(发送参数); 

</script>
