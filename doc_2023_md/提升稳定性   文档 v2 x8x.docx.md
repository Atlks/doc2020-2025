提升稳定性   文档shnk项目


其他案例 客机从生产到投入运营，可靠性放

所乘坐的客机从生产到投入运营，任何细节都是将 可靠性放在第一位的，简单来说，体现在:
设计阶段:
方案尽量简化，冗余设计，采用成熟经过验证的技术，标准化，健壮性设计等等.
测试阶段:
气动力试验,环境试验, 可靠性与寿命试验,真实试飞,各项极限测试等等
运行阶段:
执飞前检查，运行状态监控，定期维护检修.
机组:
持证上岗，定期培训，考核

稳定性设计

全面trycatch  所有api都加挂try

十 jarkas 大鱼 刘洋 汤姆, [26/08/2023 12:39 pm]
一般有两种手法来处理这种情况：一种是判空处理，如(res  []).length，（res  {}).name等；另外一种是全部按理想情况写，但是外层用try{...}catch(){...}包裹，一有异常就抛出去，通过过滤错误来确保try后面的代码仍能正常执行

增强api lib 对所有重要api加挂ex try
同时还要记录日志方便排查。。。
Lib日志。总日志log
Reqchain 日志。。

错误日志后面附加ERR
防止主循环崩溃 FOR结构强制try ex
默认值设计 如果娶不到需要默认值
语言的全局狗子ex  and 框架tp的全局ex钩子
Call fun模式 调用重要流程 里面ex 和log了已经
荣誉设计 http 需要
双发 重试机制
消息队列设计，每个消息储存下来 方便分析。处理完毕移动到完毕文件夹


架构稳定性 设计

语言使用js php scrpt
接口调用使用cmd模式

Mgdb回自动结构同步稳定性更好

语言编写 提升稳定性
Webhk trycatch  子任务，防止主流查崩溃
Webhook恢复指令
Chkbot prcs
多jia if exist判断
路径和其他要大小写一致，防止linux和wind不抑郁


测试
单源测试单独目录unitest ，测试文件放前面，前面增加0 
测试数据可以放后面

单元测试通过后local集成测试
每次进行更新说明 重点测试
在线服务器测试

增加恢复命令 与监控守护
增加代码预数据备份  自动化备份
重要的进程监护命令
恢复webhok指令
恢复log权限

增加守护程序 定时执行
 

# 设置日志权限

chmod -R 777 /www/wwwroot/game.gq.cc/runtime
通常木马会修改这些DLL文件，以此来启动自己入侵您的电脑。如果不是您主动修改，请阻止。


操作流程规范
同步线上程序
测试。。备份
部署


异常处理：在正确性和健壮性之间做好取舍
正确性是指：程序永不返回不准确的结果，即使这样做会不返回结果或是直接退出程序。
健壮性是指：系统在不正常的输入或不正常的外部环境下仍能正常运行，哪怕输出结果是错误的或者不完整的。 正确性和健壮性往往是相互矛盾的，当我们检查出错误数据后，还需要决定如何处理它。防御性编程不会掩盖错误，也不会隐藏 bug。这需要在健壮性和正确性之间做权衡。在对异常低容忍度的场景，比如火箭发射系统或医疗系统，正确性要优于健壮性；在电商等消费场景中，要优先考虑健壮性，毕竟选择商品不成功，重新刷新一下就好了。


2、换用下一个正确的数据
在处理轮询查询状态的子程序时，如果某次查询出的输出数据错误或有误，大可以忽略本次错误的数据，继续等待下一次轮询时读取正确的数据
（例如，如果你以每秒100次的速度读取体温计的数据，如果某一次得到的数据有误，我们可以再等上1/100秒后继续读取正确的数据）


 3、返回与前次相同的数据
还是举上一个例子，如果体温计在1/100秒读取到的是一个错误数据，那么大可以返回上一次正确的数据，因为温度在1/100秒内变化不会太大。
4、换用最接近的合法值
比如，当我们在编写一个滑块在规定区域内滑动的程序时，如果滑块超过规定区域，我们可以取最接近于超过区域的安全数值返回。
5、把警告信息记录到日志文件中
在检测到错误数据时，可以选择在日志文件中记录一条警告信息，然后继续执行。


 8、当错误发生时显示出错消息
这种方法可以把错误处理的开销减到最小，然而你需要衡量此时的错误消息对于用户而言是否是友善的，相反对于攻击者而言，尽量不要让他们利用错误信息来发现如何攻击这个系统。





防御式编程的理念
边界防御：检查所有的外部输入
在防御式编程的理念中，所有的外部输入都是不可信的，需要校验是否在可允许的范围内。这里需要

十 jarkas 大鱼 刘洋 汤姆, [26/08/2023 12:45 pm]
什么是防御式编程？
防御式编程，其核心思想是 子程序应该不因传入错误数据而被破坏，哪怕是由其他子程序产生的错误数据。简单来说，就是怀疑一切，认为自身代   使用 call fub模式来实现。。类库类的使用增强api

十 jarkas 大鱼 刘洋 汤姆, [26/08/2023 12:46 pm]
减少依赖：write once, run anywhere
"write once, run anywhere" 是 Sun 公司用来展示 Java 程序设计语言的跨平台特性的口号，这本身就是一种防御式编程的理念体现，即在代码中减少对环境的依赖，确保外界环境改变了，程序依然可以正常运行。

十 jarkas 大鱼 刘洋 汤姆, [26/08/2023 12:47 pm]
避免过度设计
过度的防御式编程，也会带来新的问题：

首先是预防不可能会发生的错误，如上面的 case 所示，对于数据库返回的结果，采用 rs.next () 即可判断是否有值，而不需要对 rs 进行非 null 判断； 其次，过多的防御式代码，会导致整体程序显得臃肿、难以维护，代码里充斥着大量的判断和非业务代码；同时，程序的性能也会受此影响； 然后，当代码中有非常多的异常捕捉和处理时，可能会导致异常被吞掉，没有正常地报出来。通过 call fun和。。类库api 频繁使用的jicapihu，可以增强api。。保证异常一定要疾苦记录和var dump 屏幕回西安

十 jarkas 大鱼 刘洋 汤姆, [26/08/2023 12:48 pm]
安全编程思想。。。总结
防御式编程是一种安全的编程思想，本质上是要求开发人员对代码和线上环境报以辩证的态度和敬畏之心。它通过以下途径，从而来提升系统健壮性： 提高工程质量 —— 减少 bug 和

十 jarkas 大鱼 刘洋 汤姆, [26/08/2023 12:48 pm]
架构或高层设计中规定了是让错误处理更倾向于健壮性还是正确性？

十 jarkas 大鱼 刘洋 汤姆, [26/08/2023 12:49 pm]
安全事宜
检查有害输入数据的代码是否也检查了故意的缓冲区溢出、SQL 注入、HTML 注入、证书溢出一级其他恶意输入数据？
是否检查了所有的错误返回码
是否捕获了所有的异常？
出错消息中是否避免出现有助于攻击者攻入系统所需的信息





风险程序：  C:\Windows\System32\DriverStore\FileRepository\nvam.inf_amd64_c28a426940136317\nvdlistx.dll

发起来源：C:\Users\attil\AppData\Local\Temp\wps\~1e0fa870\applypatch.exe

目标：C:\Users\attil\AppData\Local\Kingsoft\WPS Office\12.2.0.13193\office6\addons\cef\d3dcompiler_47.dll

